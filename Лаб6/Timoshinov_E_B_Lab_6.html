<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Лабораторная работа 6: Модели нечеткого вывода. Дефаззификация</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        body {
            font-family: 'Times New Roman', serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: black;
            background-color: white;
        }
        .author {
            text-align: right;
            margin-bottom: 20px;
            font-size: 14pt;
        }
        h1 {
            text-align: center;
            font-size: 18pt;
            margin-bottom: 10px;
            font-weight: bold;
        }
        h2 {
            font-size: 16pt;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        h3 {
            font-size: 14pt;
            margin-top: 20px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        p {
            text-align: justify;
            line-height: 1.5;
            margin: 10px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: white;
            font-weight: bold;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 15px auto;
            border: 1px solid black;
        }
        .figure-caption {
            text-align: center;
            font-style: italic;
            margin-top: 5px;
            margin-bottom: 15px;
        }
        .formula {
            text-align: center;
            margin: 15px 0;
            font-style: italic;
        }
        .task {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid black;
        }
        ul, ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="author">
        <p><strong>Выполнил:</strong> Тимошинов Егор Борисович</p>
        <p><strong>Группа:</strong> 16</p>
    </div>

    <h1>Лабораторная работа 6</h1>
    <h2>Модели нечеткого вывода. Дефаззификация</h2>

    <h2>Цель работы</h2>
    <p>Изучение моделей нечеткого вывода, методов фаззификации и дефаззификации, а также применение композиционного правила вывода и упрощенного метода вывода для решения практических задач.</p>

    <h2>Теоретические сведения</h2>

    <h3>Модели нечеткого вывода</h3>
    <p>В основе моделей нечеткого вывода лежат правила, основанные на импликации:</p>
    <div class="formula">
        $$\mathbf{R}_1: \mathbf{ЕСЛИ} \left(\mathbf{x}_1 = \mathbf{A}_1\right) \mathbf{ТО} \left(\mathbf{y}_1 = \mathbf{B}_1\right)$$
        $$\mathbf{R}_2: \mathbf{ЕСЛИ} \left(\mathbf{x}_2 = \mathbf{A}_2\right) \mathbf{ТО} \left(\mathbf{y}_2 = \mathbf{B}_2\right)$$
        $$\ldots$$
        $$\mathbf{R}_n: \mathbf{ЕСЛИ} \left(\mathbf{x}_n = \mathbf{A}_n\right) \mathbf{ТО} \left(\mathbf{y}_m = \mathbf{B}_m\right)$$
    </div>
    <p>где $A_1, A_2, \ldots, A_n, B_1, B_2, \ldots, B_m$ — нечеткие множества.</p>

    <h3>Фаззификация</h3>
    <p>В процессе фаззификации четкий входной вектор $X^*$ преобразуется в вектор $M$ степеней принадлежности:</p>
    <div class="formula">
        $$\mathbf{X}^* = \left[ \begin{array}{c} x_1^* \\ x_2^* \end{array} \right] \quad \xrightarrow{\text{фаззификация}} \quad \mathbf{M} = \left[ \begin{array}{c} \mu_{A_1}(x_1^*) \\ \mu_{A_2}(x_1^*) \\ \mu_{B_1}(x_2^*) \\ \mu_{B_2}(x_2^*) \end{array} \right]$$
    </div>

    <h3>Вывод с нечетким входным сигналом</h3>
    <p>Когда на вход модели подается нечеткое множество $A^*$ вместо четкого значения, используется композиционное правило вывода (обобщенный Modus Ponens):</p>
    <div class="formula">
        $$A^* \circ (A \to B) = B^*$$
    </div>
    <p>где композиция выполняется по формуле:</p>
    <div class="formula">
        $$\mu_{B^*}(y) = \max_{x \in X} \min \left( \mu_{A^{**}}(x, y), \mu_{R}(x, y) \right)$$
    </div>
    <p>где $A^{**}$ — цилиндрическое продолжение множества $A^*$ на $X \times Y$.</p>

    <h3>Упрощенный метод вывода</h3>
    <p>Упрощенный метод вывода использует формулу:</p>
    <div class="formula">
        $$h = \max_{x \in X} \min \left( \mu_{A}(x), \mu_{A^*}(x) \right)$$
    </div>
    <p>где $h$ — степень выполнения условия правила. Затем функция принадлежности заключения ограничивается значением $h$:</p>
    <div class="formula">
        $$\mu_{B^*}(y) = \min(h, \mu_{B}(y))$$
    </div>

    <h3>Max-Prod метод</h3>
    <p>Вместо операции MIN для T-нормы можно использовать операцию PROD (умножение). В этом случае:</p>
    <div class="formula">
        $$\mu_{B^*}(y) = \max \left( h_1 \cdot \mu_{C_1}(y), h_2 \cdot \mu_{C_2}(y), \ldots, h_n \cdot \mu_{C_n}(y) \right)$$
    </div>
    <p>где $h_i$ вычисляются с использованием операции умножения вместо минимума.</p>

    <h3>Дефаззификация</h3>
    <p>Дефаззификация — процесс преобразования нечеткого множества в четкое значение. Основные методы:</p>
    <ul>
        <li><strong>Метод центра тяжести (центроид):</strong> $z^* = \frac{\int z \cdot \mu(z) dz}{\int \mu(z) dz}$</li>
        <li><strong>Метод среднего максимума (MOM):</strong> среднее значение всех элементов с максимальной степенью принадлежности</li>
        <li><strong>Метод первого максимума (FOM):</strong> первое значение с максимальной степенью принадлежности</li>
        <li><strong>Метод последнего максимума (LOM):</strong> последнее значение с максимальной степенью принадлежности</li>
    </ul>

    <h2>Практическая часть</h2>

    <div class="task">
        <h3>Задание 1: Дискретизация нечетких множеств с применением PROD и метода 2</h3>
        <p><strong>Задача:</strong> Выполнить дискретизацию нечетких множеств с применением операции PROD (произведение) вместо MIN для T-нормы.</p>

        <p><strong>Решение:</strong></p>
        <p>Для переменной $x$ (количество чашек кофе) определены нечеткие множества:</p>
        <ul>
            <li>$A_1$ — мало чашек кофе: $\mu_{A_1}(x) = 1 - 0.5x$ для $x \in [0, 2]$</li>
            <li>$A_2$ — много чашек кофе: $\mu_{A_2}(x) = 0.5x$ для $x \in [0, 2]$</li>
        </ul>

        <p>Для переменной $y$ (время отхода ко сну) определены нечеткие множества:</p>
        <ul>
            <li>$B_1$ — рано ложиться: $\mu_{B_1}(y) = 1 - 0.5(y-20)/2$ для $y \in [20, 22]$</li>
            <li>$B_2$ — поздно ложиться: $\mu_{B_2}(y) = 0.5(y-20)/2$ для $y \in [20, 22]$</li>
        </ul>

        <p>При использовании операции PROD вместо MIN, декартово произведение вычисляется как:</p>
        <div class="formula">
            $$\mu_{A \times B}(x, y) = \mu_A(x) \cdot \mu_B(y)$$
        </div>
        <p>вместо</p>
        <div class="formula">
            $$\mu_{A \times B}(x, y) = \min(\mu_A(x), \mu_B(y))$$
        </div>

        <p>Графики дискретизированных нечетких множеств и сравнение операций MIN и PROD представлены на рисунке 1:</p>
        <img src="task1_discretization.png" alt="Дискретизация нечетких множеств с PROD">
        <div class="figure-caption">Рисунок 1. Дискретизация нечетких множеств с применением PROD</div>

        <p><strong>Анализ результатов:</strong></p>
        <p>При использовании операции PROD значения функции принадлежности для декартова произведения получаются меньше, чем при использовании MIN, так как произведение двух чисел из интервала [0, 1] всегда меньше или равно минимуму этих чисел. Это приводит к более консервативной оценке степени принадлежности.</p>
    </div>

    <div class="task">
        <h3>Задание 2: Изучение вывода с нечетким входным сигналом</h3>
        <p><strong>Теоретический материал:</strong></p>
        <p>При подаче на вход модели нечеткого множества $A^*$ вместо четкого значения используется композиционное правило вывода.</p>

        <h4>Композиционное правило вывода</h4>
        <p>Процесс включает следующие шаги:</p>
        <ol>
            <li>Создание цилиндрического продолжения $A^{**}$ множества $A^*$ на пространство $X \times Y$</li>
            <li>Вычисление композиции: $\min(\mu_{A^{**}}(x, y), \mu_{R}(x, y))$</li>
            <li>Проекция на область определения $Y$: $\mu_{B^*}(y) = \max_{x \in X} \min(\mu_{A^{**}}(x, y), \mu_{R}(x, y))$</li>
        </ol>

        <p>Альтернативный способ — матричное умножение, где операция умножения заменяется на MIN, а сложения на MAX:</p>
        <div class="formula">
            $$A^* \circ R = \mu_{B^*}(y) = \max_{x \in X} \min(\mu_{A^*}(x), \mu_{R}(x, y))$$
        </div>

        <h4>Упрощенный метод вывода</h4>
        <p>Упрощенный метод основан на вычислении степени выполнения условия правила:</p>
        <div class="formula">
            $$h = \max_{x \in X} \min \left( \mu_{A}(x), \mu_{A^*}(x) \right)$$
        </div>
        <p>Затем функция принадлежности заключения ограничивается значением $h$:</p>
        <div class="formula">
            $$\mu_{B^*}(y) = \min(h, \mu_{B}(y))$$
        </div>
        <p>Этот метод проще в вычислениях, но дает менее точные результаты по сравнению с композиционным правилом.</p>
    </div>

    <div class="task">
        <h3>Задание 3: Задача о кофе и самочувствии</h3>
        <p><strong>Условие задачи:</strong></p>
        <p>Система содержит две входных переменных: $x$ — число выпитых чашек кофе в день, $y$ — время отхода ко сну. Выходная переменная $z$ — вероятность чувствовать себя нормально на другой день.</p>

        <p>Возможные значения переменной $x$:</p>
        <ul>
            <li>$A_1$ — мало чашек кофе в день</li>
            <li>$A_2$ — много чашек кофе в день</li>
        </ul>

        <p>Возможные значения переменной $y$:</p>
        <ul>
            <li>$B_1$ — укладываться спать рано</li>
            <li>$B_2$ — укладываться спать поздно</li>
        </ul>

        <p>Выходные нечеткие множества (значения переменной $z$):</p>
        <ul>
            <li>$C_1$ — чувствовать себя хорошо на следующий день</li>
            <li>$C_2$ — чувствовать себя нормально на следующий день</li>
            <li>$C_3$ — чувствовать себя плохо на следующий день</li>
        </ul>

        <p><strong>Входные данные:</strong></p>
        <ul>
            <li>$A^*$ — выпить не очень много чашек за день</li>
            <li>$B^*$ — лечь спать не очень поздно</li>
        </ul>

        <p><strong>Система правил:</strong></p>
        <ol>
            <li>$R_1$: ЕСЛИ $x = A_1$ И $y = B_1$ ТО $z = C_1$ (мало кофе и рано = хорошо)</li>
            <li>$R_2$: ЕСЛИ $x = A_1$ И $y = B_2$ ТО $z = C_2$ (мало кофе и поздно = нормально)</li>
            <li>$R_3$: ЕСЛИ $x = A_2$ И $y = B_1$ ТО $z = C_2$ (много кофе и рано = нормально)</li>
            <li>$R_4$: ЕСЛИ $x = A_2$ И $y = B_2$ ТО $z = C_3$ (много кофе и поздно = плохо)</li>
        </ol>

        <h4>Решение методом Max-Min (упрощенный метод)</h4>
        <p>Вычисляем степени выполнения условий правил:</p>
        <div class="formula">
            $$h_1 = \min\left(\max_{x} \min(\mu_{A_1}(x), \mu_{A^*}(x)), \max_{y} \min(\mu_{B_1}(y), \mu_{B^*}(y))\right)$$
            $$h_2 = \min\left(\max_{x} \min(\mu_{A_1}(x), \mu_{A^*}(x)), \max_{y} \min(\mu_{B_2}(y), \mu_{B^*}(y))\right)$$
            $$h_3 = \min\left(\max_{x} \min(\mu_{A_2}(x), \mu_{A^*}(x)), \max_{y} \min(\mu_{B_1}(y), \mu_{B^*}(y))\right)$$
            $$h_4 = \min\left(\max_{x} \min(\mu_{A_2}(x), \mu_{A^*}(x)), \max_{y} \min(\mu_{B_2}(y), \mu_{B^*}(y))\right)$$
        </div>

        <p>Результирующая функция принадлежности:</p>
        <div class="formula">
            $$\mu_{res}(z) = \max\left(\min(h_1, \mu_{C_1}(z)), \min(h_2, \mu_{C_2}(z)), \min(h_3, \mu_{C_2}(z)), \min(h_4, \mu_{C_3}(z))\right)$$
        </div>

        <h4>Решение методом Max-Prod</h4>
        <p>При использовании операции PROD вместо MIN:</p>
        <div class="formula">
            $$h_i^{prod} = \max_{x} (\mu_{A_i}(x) \cdot \mu_{A^*}(x)) \cdot \max_{y} (\mu_{B_i}(y) \cdot \mu_{B^*}(y))$$
        </div>

        <p>Результирующая функция принадлежности:</p>
        <div class="formula">
            $$\mu_{res}^{prod}(z) = \max\left(h_1^{prod} \cdot \mu_{C_1}(z), h_2^{prod} \cdot \mu_{C_2}(z), h_3^{prod} \cdot \mu_{C_2}(z), h_4^{prod} \cdot \mu_{C_3}(z)\right)$$
        </div>

        <h4>Решение композиционным правилом вывода</h4>
        <p>Создаем нечеткие отношения для каждого правила $R_i: A_i \times B_i \to C_i$, затем объединяем их операцией MAX. Выполняем композицию входного нечеткого множества с объединенным отношением и проектируем на область определения $Z$.</p>

        <p>Графики входных нечетких множеств и результаты вывода представлены на рисунке 2:</p>
        <img src="task3_coffee_wellbeing.png" alt="Решение задачи о кофе и самочувствии">
        <div class="figure-caption">Рисунок 2. Решение задачи о кофе и самочувствии</div>

        <p>Графики выходных нечетких множеств представлены на рисунке 2а:</p>
        <img src="task3_output_sets.png" alt="Выходные нечеткие множества">
        <div class="figure-caption">Рисунок 2а. Выходные нечеткие множества C1, C2, C3</div>

        <p><strong>Сравнение Max-Min и Max-Prod:</strong></p>
        <p>При использовании Max-Prod значения функции принадлежности результирующего множества получаются меньше, чем при Max-Min, так как произведение всегда меньше или равно минимуму. Это приводит к более "осторожным" выводам системы.</p>
    </div>

    <div class="task">
        <h3>Задание 4: Дефаззификация</h3>
        <p><strong>Задача:</strong> Выполнить дефаззификацию нечеткого множества, полученного в задании 3, используя различные методы.</p>

        <p><strong>Решение:</strong></p>
        <p>Для дефаззификации нечеткого множества $\mu_{res}(z)$ применяются следующие методы:</p>

        <h4>1. Метод центра тяжести (центроид)</h4>
        <div class="formula">
            $$z^* = \frac{\sum_{i} z_i \cdot \mu_{res}(z_i)}{\sum_{i} \mu_{res}(z_i)}$$
        </div>

        <h4>2. Метод среднего максимума (MOM)</h4>
        <p>Находим все значения $z_i$, для которых $\mu_{res}(z_i) = \max(\mu_{res})$, и вычисляем их среднее арифметическое.</p>

        <h4>3. Метод первого максимума (FOM)</h4>
        <p>Выбираем первое значение $z_i$ с максимальной степенью принадлежности.</p>

        <h4>4. Метод последнего максимума (LOM)</h4>
        <p>Выбираем последнее значение $z_i$ с максимальной степенью принадлежности.</p>

        <h4>5. Метод взвешенного среднего</h4>
        <div class="formula">
            $$z^* = \frac{\sum_{i} z_i \cdot w_i}{\sum_{i} w_i}$$
        </div>
        <p>где $w_i = \mu_{res}(z_i)$ — веса.</p>

        <p>График дефаззификации представлен на рисунке 3:</p>
        <img src="task4_defuzzification.png" alt="Дефаззификация нечеткого множества">
        <div class="figure-caption">Рисунок 3. Дефаззификация нечеткого множества</div>

        <p><strong>Результаты дефаззификации (Max-Min):</strong></p>
        <table>
            <tr>
                <th>Метод</th>
                <th>Результат</th>
            </tr>
            <tr>
                <td>Центроид</td>
                <td>—</td>
            </tr>
            <tr>
                <td>MOM</td>
                <td>—</td>
            </tr>
            <tr>
                <td>FOM</td>
                <td>—</td>
            </tr>
            <tr>
                <td>LOM</td>
                <td>—</td>
            </tr>
            <tr>
                <td>Взвешенное среднее</td>
                <td>—</td>
            </tr>
        </table>
        <div class="figure-caption">Таблица 1. Результаты дефаззификации (Max-Min)</div>

        <p><strong>Результаты дефаззификации (Max-Prod):</strong></p>
        <table>
            <tr>
                <th>Метод</th>
                <th>Результат</th>
            </tr>
            <tr>
                <td>Центроид</td>
                <td>—</td>
            </tr>
            <tr>
                <td>MOM</td>
                <td>—</td>
            </tr>
            <tr>
                <td>FOM</td>
                <td>—</td>
            </tr>
            <tr>
                <td>LOM</td>
                <td>—</td>
            </tr>
            <tr>
                <td>Взвешенное среднее</td>
                <td>—</td>
            </tr>
        </table>
        <div class="figure-caption">Таблица 2. Результаты дефаззификации (Max-Prod)</div>

        <p><strong>Анализ результатов:</strong></p>
        <p>Метод центра тяжести (центроид) является наиболее распространенным методом дефаззификации, так как он учитывает все значения функции принадлежности и дает сглаженный результат. Методы MOM, FOM и LOM используются в случаях, когда важно выбрать конкретное значение из области максимума функции принадлежности.</p>
    </div>

    <h2>Выводы</h2>
    <p>В ходе выполнения лабораторной работы изучены:</p>
    <ol>
        <li>Методы дискретизации нечетких множеств с применением различных T-норм (MIN и PROD)</li>
        <li>Композиционное правило вывода и упрощенный метод вывода для нечетких систем</li>
        <li>Применение методов Max-Min и Max-Prod для нечеткого вывода</li>
        <li>Различные методы дефаззификации нечетких множеств</li>
    </ol>
    <p>Практическое применение рассмотрено на примере задачи о влиянии количества выпитого кофе и времени отхода ко сну на самочувствие на следующий день. Показано, что использование различных T-норм (MIN и PROD) приводит к различным результатам вывода, что позволяет выбирать более подходящий метод в зависимости от конкретной задачи.</p>

</body>
</html>

