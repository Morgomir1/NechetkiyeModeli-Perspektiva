<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Лабораторная работа 7: Модель Мамдани (часть 1)</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        body {
            font-family: 'Times New Roman', serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: black;
            background-color: white;
        }
        .author {
            text-align: right;
            margin-bottom: 20px;
            font-size: 14pt;
        }
        h1 {
            text-align: center;
            font-size: 18pt;
            margin-bottom: 10px;
            font-weight: bold;
        }
        h2 {
            font-size: 16pt;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        h3 {
            font-size: 14pt;
            margin-top: 20px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        p {
            text-align: justify;
            line-height: 1.5;
            margin: 10px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: white;
            font-weight: bold;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 15px auto;
            border: 1px solid black;
        }
        .figure-caption {
            text-align: center;
            font-style: italic;
            margin-top: 5px;
            margin-bottom: 15px;
        }
        .formula {
            text-align: center;
            margin: 15px 0;
            font-style: italic;
        }
        .task {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid black;
        }
        ul, ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="author">
        <p><strong>Выполнил:</strong> Тимошинов Егор Борисович</p>
        <p><strong>Группа:</strong> 16</p>
    </div>

    <h1>Лабораторная работа 7</h1>
    <h2>Модель Мамдани (часть 1)</h2>

    <h2>Цель работы</h2>
    <p>Изучение модели Мамдани как одного из основных методов нечеткого логического вывода, понимание этапов её работы (фаззификация, активация правил, агрегация, дефаззификация) и практическое применение для решения задачи определения самочувствия на основе количества выпитого кофе и времени отхода ко сну.</p>

    <h2>Теоретические сведения</h2>

    <h3>Модель Мамдани</h3>
    <p>Модель Мамдани — один из наиболее распространенных методов нечеткого логического вывода, предложенный Эбрахимом Мамдани в 1975 году. Данная модель использует нечеткие множества как в посылках (антецедентах), так и в заключениях (консеквентах) правил.</p>

    <p>Модель Мамдани состоит из следующих этапов:</p>
    <ol>
        <li><strong>Фаззификация:</strong> преобразование четких входных значений в степени принадлежности нечетким множествам.</li>
        <li><strong>Активация правил:</strong> вычисление степени выполнения условий каждого правила с использованием T-нормы (обычно MIN).</li>
        <li><strong>Ограничение выходных множеств:</strong> применение степени активации к выходным нечетким множествам (усечение).</li>
        <li><strong>Агрегация:</strong> объединение выходных множеств всех правил с использованием T-конормы (обычно MAX).</li>
        <li><strong>Дефаззификация:</strong> преобразование результирующего нечеткого множества в четкое выходное значение.</li>
    </ol>

    <h3>Математическое описание</h3>
    <p>Рассмотрим систему нечетких правил:</p>
    <div class="formula">
        $$\mathbf{R}_1: \mathbf{ЕСЛИ} \left(\mathbf{x}_1 = \mathbf{A}_1\right) \mathbf{И} \left(\mathbf{x}_2 = \mathbf{B}_1\right) \mathbf{ТО} \left(\mathbf{y} = \mathbf{C}_1\right)$$
        $$\mathbf{R}_2: \mathbf{ЕСЛИ} \left(\mathbf{x}_1 = \mathbf{A}_2\right) \mathbf{И} \left(\mathbf{x}_2 = \mathbf{B}_2\right) \mathbf{ТО} \left(\mathbf{y} = \mathbf{C}_2\right)$$
        $$\ldots$$
    </div>

    <p><strong>Этап 1: Фаззификация</strong></p>
    <p>Для четких входных значений $x_1^*$ и $x_2^*$ вычисляются степени принадлежности:</p>
    <div class="formula">
        $$\mu_{A_i}(x_1^*), \quad \mu_{B_j}(x_2^*)$$
    </div>

    <p><strong>Этап 2: Активация правил</strong></p>
    <p>Степень активации правила вычисляется как минимум (T-норма MIN) степеней принадлежности условий:</p>
    <div class="formula">
        $$h_i = \min\left(\mu_{A_i}(x_1^*), \mu_{B_j}(x_2^*)\right)$$
    </div>

    <p><strong>Этап 3: Ограничение выходных множеств</strong></p>
    <p>Выходное нечеткое множество каждого правила ограничивается значением степени активации:</p>
    <div class="formula">
        $$\mu_{C_i^*}(y) = \min(h_i, \mu_{C_i}(y))$$
    </div>

    <p><strong>Этап 4: Агрегация</strong></p>
    <p>Результирующее выходное множество получается объединением всех ограниченных множеств с использованием максимума (T-конорма MAX):</p>
    <div class="formula">
        $$\mu_{res}(y) = \max\left(\mu_{C_1^*}(y), \mu_{C_2^*}(y), \ldots, \mu_{C_n^*}(y)\right)$$
    </div>

    <p><strong>Этап 5: Дефаззификация</strong></p>
    <p>Наиболее распространенный метод дефаззификации — метод центра тяжести (центроид):</p>
    <div class="formula">
        $$y^* = \frac{\int y \cdot \mu_{res}(y) dy}{\int \mu_{res}(y) dy}$$
    </div>

    <p>В дискретном случае:</p>
    <div class="formula">
        $$y^* = \frac{\sum_{i} y_i \cdot \mu_{res}(y_i)}{\sum_{i} \mu_{res}(y_i)}$$
    </div>

    <h2>Практическая часть</h2>

    <div class="task">
        <h3>Задание: Определение самочувствия на основе количества кофе и времени отхода ко сну</h3>
        
        <p><strong>Постановка задачи:</strong></p>
        <p>Разработать модель Мамдани для определения вероятности хорошего самочувствия на следующий день на основе двух входных переменных:</p>
        <ul>
            <li><strong>$x$</strong> — количество выпитых чашек кофе в день (диапазон: 0–6 чашек)</li>
            <li><strong>$y$</strong> — время отхода ко сну (диапазон: 20:00–02:00, представлено как 20–26)</li>
        </ul>

        <p><strong>Выходная переменная:</strong></p>
        <ul>
            <li><strong>$z$</strong> — вероятность хорошего самочувствия на следующий день (диапазон: 0–1)</li>
        </ul>

        <h4>Нечеткие множества входных переменных</h4>
        <p><strong>Для переменной $x$ (количество чашек кофе):</strong></p>
        <ul>
            <li>$A_1$ — мало чашек кофе:
                $$\mu_{A_1}(x) = \begin{cases} 1 - 0.5x, & 0 \leq x \leq 2 \\ 0, & x > 2 \end{cases}$$
            </li>
            <li>$A_2$ — много чашек кофе:
                $$\mu_{A_2}(x) = \begin{cases} 0.5x, & 0 \leq x \leq 2 \\ 0.5x, & x > 2 \end{cases}$$
            </li>
        </ul>

        <p><strong>Для переменной $y$ (время отхода ко сну):</strong></p>
        <ul>
            <li>$B_1$ — рано ложиться спать (до 22:00):
                $$\mu_{B_1}(y) = \begin{cases} 1 - 0.5\frac{y-20}{2}, & 20 \leq y \leq 22 \\ 0, & y > 22 \end{cases}$$
            </li>
            <li>$B_2$ — поздно ложиться спать (после 22:00):
                $$\mu_{B_2}(y) = \begin{cases} 0.5\frac{y-20}{2}, & 20 \leq y \leq 22 \\ 0.5\frac{y-20}{2}, & y > 22 \end{cases}$$
            </li>
        </ul>

        <h4>Нечеткие множества выходной переменной</h4>
        <p><strong>Для переменной $z$ (вероятность хорошего самочувствия):</strong></p>
        <ul>
            <li>$C_1$ — чувствовать себя хорошо (трапециевидная функция с максимумом на [0.4, 0.6])</li>
            <li>$C_2$ — чувствовать себя нормально (трапециевидная функция с максимумом на [0.4, 0.6])</li>
            <li>$C_3$ — чувствовать себя плохо (убывающая функция с максимумом при $z = 0$)</li>
        </ul>

        <h4>Система правил</h4>
        <ol>
            <li>$R_1$: ЕСЛИ $x = A_1$ (мало кофе) И $y = B_1$ (рано) ТО $z = C_1$ (хорошо)</li>
            <li>$R_2$: ЕСЛИ $x = A_1$ (мало кофе) И $y = B_2$ (поздно) ТО $z = C_2$ (нормально)</li>
            <li>$R_3$: ЕСЛИ $x = A_2$ (много кофе) И $y = B_1$ (рано) ТО $z = C_2$ (нормально)</li>
            <li>$R_4$: ЕСЛИ $x = A_2$ (много кофе) И $y = B_2$ (поздно) ТО $z = C_3$ (плохо)</li>
        </ol>

        <h4>Решение</h4>
        <p>Рассмотрим пример: выпито $x^* = 1.5$ чашек кофе, отход ко сну в $y^* = 21.5$ (21:30).</p>

        <p><strong>Шаг 1: Фаззификация</strong></p>
        <p>Вычисляем степени принадлежности входных значений:</p>
        <ul>
            <li>$\mu_{A_1}(1.5) = 1 - 0.5 \cdot 1.5 = 0.25$</li>
            <li>$\mu_{A_2}(1.5) = 0.5 \cdot 1.5 = 0.75$</li>
            <li>$\mu_{B_1}(21.5) = 1 - 0.5 \cdot \frac{21.5-20}{2} = 0.625$</li>
            <li>$\mu_{B_2}(21.5) = 0.5 \cdot \frac{21.5-20}{2} = 0.375$</li>
        </ul>

        <p><strong>Шаг 2: Активация правил (MIN для условий)</strong></p>
        <table>
            <tr>
                <th>Правило</th>
                <th>Условие</th>
                <th>Степень активации $h_i$</th>
            </tr>
            <tr>
                <td>$R_1$</td>
                <td>$A_1$ И $B_1$</td>
                <td>$h_1 = \min(0.25, 0.625) = 0.25$</td>
            </tr>
            <tr>
                <td>$R_2$</td>
                <td>$A_1$ И $B_2$</td>
                <td>$h_2 = \min(0.25, 0.375) = 0.25$</td>
            </tr>
            <tr>
                <td>$R_3$</td>
                <td>$A_2$ И $B_1$</td>
                <td>$h_3 = \min(0.75, 0.625) = 0.625$</td>
            </tr>
            <tr>
                <td>$R_4$</td>
                <td>$A_2$ И $B_2$</td>
                <td>$h_4 = \min(0.75, 0.375) = 0.375$</td>
            </tr>
        </table>

        <p><strong>Шаг 3: Ограничение выходных множеств</strong></p>
        <p>Для каждого правила ограничиваем выходное множество значением степени активации:</p>
        <ul>
            <li>$\mu_{C_1^*}(z) = \min(0.25, \mu_{C_1}(z))$ для правила $R_1$</li>
            <li>$\mu_{C_2^*}(z) = \min(0.25, \mu_{C_2}(z))$ для правила $R_2$</li>
            <li>$\mu_{C_2^*}(z) = \min(0.625, \mu_{C_2}(z))$ для правила $R_3$</li>
            <li>$\mu_{C_3^*}(z) = \min(0.375, \mu_{C_3}(z))$ для правила $R_4$</li>
        </ul>

        <p><strong>Шаг 4: Агрегация (MAX для объединения)</strong></p>
        <p>Результирующая функция принадлежности:</p>
        <div class="formula">
            $$\mu_{res}(z) = \max\left(\min(0.25, \mu_{C_1}(z)), \min(0.25, \mu_{C_2}(z)), \min(0.625, \mu_{C_2}(z)), \min(0.375, \mu_{C_3}(z))\right)$$
        </div>

        <p><strong>Шаг 5: Дефаззификация</strong></p>
        <p>Используя метод центра тяжести (центроид), получаем четкое выходное значение $z^*$.</p>

        <p>Графики входных нечетких множеств, процесса активации правил и результата агрегации представлены на следующих рисунках:</p>
        <img src="mamdani_input_output.png" alt="Фаззификация входных переменных и выходные множества">
        <div class="figure-caption">Рисунок 1. Фаззификация входных переменных и выходные нечеткие множества</div>

        <img src="mamdani_rules.png" alt="Активация правил модели Мамдани">
        <div class="figure-caption">Рисунок 2. Процесс активации правил модели Мамдани</div>

        <img src="mamdani_aggregation.png" alt="Агрегация выходных множеств и дефаззификация">
        <div class="figure-caption">Рисунок 3. Агрегированное выходное множество и результат дефаззификации</div>

        <p><strong>Анализ результатов:</strong></p>
        <p>Модель Мамдани позволяет учесть все правила одновременно и получить результирующее нечеткое множество, которое отражает комбинированное влияние всех условий. Дефаззификация преобразует это нечеткое множество в конкретное числовое значение вероятности хорошего самочувствия.</p>

        <p>В данном примере наибольшую активацию получило правило $R_3$ ($h_3 = 0.625$), что соответствует ситуации "много кофе и рано спать", приводящей к "нормальному" самочувствию. Это объясняется тем, что хотя выпито не очень много кофе (1.5 чашки соответствует больше "много", чем "мало"), но и легли спать не очень поздно, что компенсирует влияние кофеина.</p>
    </div>

    <h2>Особенности модели Мамдани</h2>
    <p>Модель Мамдани имеет следующие характеристики:</p>
    <ul>
        <li><strong>Интерпретируемость:</strong> выходные нечеткие множества имеют четкий семантический смысл, что делает модель понятной для экспертов.</li>
        <li><strong>Гибкость:</strong> возможность использования различных T-норм и T-конорм для операций И и ИЛИ.</li>
        <li><strong>Вычислительная эффективность:</strong> алгоритм является достаточно простым для реализации.</li>
        <li><strong>Применимость:</strong> модель хорошо подходит для задач, где важна экспертная интерпретация результатов.</li>
    </ul>

    <h2>Выводы</h2>
    <p>В ходе выполнения лабораторной работы:</p>
    <ol>
        <li>Изучена модель Мамдани как метод нечеткого логического вывода.</li>
        <li>Реализованы все этапы модели Мамдани: фаззификация, активация правил, ограничение выходных множеств, агрегация и дефаззификация.</li>
        <li>Применена модель Мамдани для решения практической задачи определения самочувствия на основе количества выпитого кофе и времени отхода ко сну.</li>
        <li>Продемонстрировано, что модель Мамдани позволяет учитывать все правила одновременно и получать интерпретируемые результаты.</li>
    </ol>
    <p>Модель Мамдани является эффективным инструментом для решения задач нечеткого вывода, особенно когда требуется сохранить семантику нечетких множеств в выходных результатах и обеспечить понятность модели для экспертов.</p>

</body>
</html>
